!function(e){function t(t){for(var r,i,l=t[0],s=t[1],c=t[2],f=0,p=[];f<l.length;f++)i=l[f],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&p.push(o[i][0]),o[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);for(u&&u(t);p.length;)p.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,l=1;l<n.length;l++){var s=n[l];0!==o[s]&&(r=!1)}r&&(a.splice(t--,1),e=i(i.s=n[0]))}return e}var r={},o={2:0},a=[];function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var l=window.webpackJsonp=window.webpackJsonp||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=s;a.push([15,0]),n()}({15:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Fe}));var r=n(0),o=n.n(r),a=n(13),i=n.n(a),l=["A","B","C","D","E","F","G","H","I","J","K","L"],s=function(e){return e.filter((function(e){return e.damage<e.size})).sort((function(e,t){return t.size-e.size}))[0]},c=function(e){return e.filter((function(e){return e.damage<e.size})).length},u=function(e){return e[Math.floor(Math.random()*e.length)]},f=function(e,t){for(var n=[],r=0;r<e.length;r++)for(var o=0;o<e.length;o++){var a=e[r][o];t(a)&&n.push(a)}return n},p=function(e){for(var t=0,n=0;n<e.length;n++)for(var r=0;r<e.length;r++){var o=e[n][r];h(o)||t++}return t},h=function(e){return e&&!e.isHit&&!e.isKilledShipNeighborCell},y=function(e){return f(e,h)},m=function(e){return u(f(e,h))},d=n(8);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?S(e):t}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(r,e);var t,n=(t=r,function(){var e,n=w(t);if(E()){var r=w(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return v(this,e)});function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),x(S(t=n.call(this,e)),"_collectArrayRooms",(function(e,n,r,o){for(var a=[],i=0;i<=e.length-n;i++){var l=e.slice(i,i+n);if(l.length<n)break;for(var s=!0,c=0;c<l.length-1;c++)if(o(l,c)){s=!1;break}s&&(a.push({roomId:r+"_"+l.map((function(e){return e.id})).join("-"),roomCells:l}),i+=t.state.step-1)}return a})),x(S(t),"_getVFreeRooms",(function(e,n,r){var o=[],a=f(e,r),i=d.a.groupBy(a,(function(e){return e.x}));return Object.keys(i).forEach((function(e){var r=i[e],a=t._collectArrayRooms(r,n,"V",(function(e,t){return e[t].y+1!==e[t+1].y}));a.length>0&&(o=o.concat(a))})),o})),x(S(t),"_getHFreeRooms",(function(e,n,r){var o=[],a=f(e,r),i=d.a.groupBy(a,(function(e){return e.y}));return Object.keys(i).forEach((function(e){var r=i[e],a=t._collectArrayRooms(r,n,"H",(function(e,t){return e[t].x+1!==e[t+1].x}));a.length>0&&(o=o.concat(a))})),o})),x(S(t),"collectRooms",(function(e,n,r){var o=t._getHFreeRooms(e,n,r),a=t._getVFreeRooms(e,n,r);o.concat(a);return{hFreeRooms:o,vFreeRooms:a}})),t.state={step:e},t}return r}(r.Component);function _(e){return!e.ship&&!e.isShipNeighbor}function O(e,t,n){P(e,t).forEach((function(e){e[n]=!0}))}function C(e,t){if(1===t)return{roomCells:[u(f(e,_))]};var n,r=new R(1).collectRooms(e,t,_);return n=100,Math.floor(Math.random()*(n+1))<70?u([r.hFreeRooms[0],r.hFreeRooms[r.hFreeRooms.length-1],r.vFreeRooms[0],r.vFreeRooms[r.vFreeRooms.length-1]]):u(r.hFreeRooms.concat(r.vFreeRooms))}var P=function(e,t){for(var n=[],r=t.y-1;r<=t.y+1;r++)if(e[r])for(var o=t.x-1;o<=t.x+1;o++){var a=e[r][o];a&&!a.ship&&n.push(a)}return n},N=function(e,t){for(var n=[],r=0;r<t.length;r++)for(var o=0;o<t.length;o++){var a=t[r][o];a.ship&&a.ship.id===e.id&&n.push(a)}n.forEach((function(e){O(t,e,"isKilledShipNeighborCell")}))};function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?H(e):t}function H(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F(e,t){var n=[];return e[t.y-1]&&e[t.y][t.x]&&n.push(e[t.y-1][t.x]),e[t.y+1]&&e[t.y][t.x]&&n.push(e[t.y+1][t.x]),e[t.y]&&e[t.y][t.x-1]&&n.push(e[t.y][t.x-1]),e[t.y]&&e[t.y][t.x+1]&&n.push(e[t.y][t.x+1]),n.filter((function(e){return h(e)}))}var D=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}(r,e);var t,n=(t=r,function(){var e,n=z(t);if(A()){var r=z(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return k(this,e)});function r(){var e;T(this,r);for(var t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return M(H(e=n.call.apply(n,[this].concat(o))),"getCells",(function(e,t){if(1===t.length)return F(e,t[0]);var n=t[0],r=t[t.length-1];if(n.x===r.x){var o=t.sort((function(e,t){return e.y-t.y}));n=o[0],r=o[o.length-1];var a=[];return e[n.y-1]&&a.push(e[n.y-1][n.x]),e[r.y+1]&&a.push(e[r.y+1][r.x]),a.filter((function(e){return h(e)}))}var i=t.sort((function(e,t){return e.x-t.x}));return n=i[0],r=i[i.length-1],[e[n.y][n.x-1],e[r.y][r.x+1]].filter((function(e){return h(e)}))})),e}return r}(r.Component);function B(e){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function K(e,t){return!t||"object"!==B(t)&&"function"!=typeof t?W(e):t}function W(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function J(e){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y(e,t)}(r,e);var t,n=(t=r,function(){var e,n=J(t);if(G()){var r=J(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return K(this,e)});function r(){var e;I(this,r);for(var t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return V(W(e=n.call.apply(n,[this].concat(o))),"getCells",(function(e){return y(e)})),e}return r}(r.Component);function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z(e,t){return!t||"object"!==q(t)&&"function"!=typeof t?$(e):t}function $(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ee(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function te(e){return(te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X(e,t)}(r,e);var t,n=(t=r,function(){var e,n=te(t);if(ee()){var r=te(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return Z(this,e)});function r(){var e;Q(this,r);for(var t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return ne($(e=n.call.apply(n,[this].concat(o))),"getCells",(function(e,t){var n=s(t).size,r=new R(n).collectRooms(e,n,(function(e){return!e.isHit&&!e.isKilledShipNeighborCell})),o=r.hFreeRooms,a=r.vFreeRooms,i=o.concat(a).flatMap((function(e){var t=e.roomCells;if(Math.floor(t.length/n)>1){for(var r=[],o=n-1;o<t.length;o+=n)r.push(t[o]);return r}return t[Math.floor(t.length/2)]})),l=[];return i.forEach((function(e){0===l.filter((function(t){return t.x===e.x&&t.y===e.y})).length&&l.push(e)})),l})),e}return r}(r.Component);function oe(e){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ie(e,t){return(ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function le(e,t){return!t||"object"!==oe(t)&&"function"!=typeof t?se(e):t}function se(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ce(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function ue(e){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pe(e){var t=e.flatMap((function(e){return e.roomCells})),n={};return t.forEach((function(t){var r=0;e.forEach((function(e){e.roomCells.forEach((function(e){e.id===t.id&&r++}))})),n[t.id]={id:t.id,count:r,cell:t},r=0})),n}function he(e){var t=[],n=0;return Object.keys(e).forEach((function(r){e[r].count===n&&t.push(e[r].cell),e[r].count>n&&(n=e[r].count,(t=[]).push(e[r].cell))})),t}var ye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ie(e,t)}(r,e);var t,n=(t=r,function(){var e,n=ue(t);if(ce()){var r=ue(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return le(this,e)});function r(){var e;ae(this,r);for(var t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return fe(se(e=n.call.apply(n,[this].concat(o))),"getCells",(function(e,t){var n=s(t).size,r=new R(1).collectRooms(e,n,(function(e){return!e.isHit&&!e.isKilledShipNeighborCell})),o=r.hFreeRooms,a=r.vFreeRooms;return he(pe(o.concat(a)))})),e}return r}(r.Component);function me(e,t){return(new re).getCells(e,t)}function de(e,t){return(new ye).getCells(e,t)}var ge=function(e,t,n,r){if(n.length>0)return u((new D).getCells(e,n));if(p(e)<10)return m(e);if(1===s(t).size)return m(e);var o=[];return 1===r&&(o=function(e){return(new U).getCells(e)}(e)),2===r&&(o=me(e,t)),3===r&&0===(o=de(e,t)).length&&(o=me(e,t)),0===o.length&&(o=m(e)),u(o)},be=n(2),ve=n(4),Se=n(10);function Ee(e){return e.highlightBattleArea?"bg-success":"bg-secondary"}function we(e,t){var n=[],r=t.isPlayer,o=!t.isPlayer,a=t.stage,i=t.lastShot,l=i&&e.x===i.x&&e.y===i.y;return(null===t.stage||o&&"STEP_READY_TO_START"===a)&&n.push("cell-disabled"),o&&"STEP_FINAL"===a&&e.ship&&!e.isHit&&n.push("cell-ship"),r&&e.ship&&!e.isHit&&n.push("cell-ship"),e.ship&&e.isHit&&e.ship.damage<e.ship.size&&n.push("cell-ship-wounded"),e.ship&&e.isHit&&e.ship.damage===e.ship.size&&n.push("cell-ship-killed"),e.ship||e.isHit||!e.isKilledShipNeighborCell||n.push("cell-not-hittable"),l||e.ship||!e.isHit||(n.push("cell-missed-hit"),n.push("cell-not-hittable")),l&&n.push("cell-last-shot"),l&&!e.ship&&n.push("cell-not-hittable"),n}function xe(e,t,n,r){var a=this,i=[];return t.forEach((function(t){i.push(o.a.createElement("div",{key:e+"_"+t.x+"-"+t.y,className:"col-sm-1 cell-base "+we(t,r).join(" "),onClick:n.bind(a,t),title:t.xLabel+""+t.yLabel+(r.isPlayer&&t.ship?" - "+t.ship.name:"")},function(e,t){var n=t.isPlayer,r=!t.isPlayer,a=t.stage,i=t.lastShot,l=i&&e.x===i.x&&e.y===i.y;if(null===t.stage||r&&"STEP_READY_TO_START"===a)return o.a.createElement(be.a,{icon:ve.a});if(r&&"STEP_FINAL"===a&&e.ship&&!e.isHit)return o.a.createElement(be.a,{icon:Se.c});if(n&&e.ship&&!e.isHit)return o.a.createElement(be.a,{icon:ve.a});if(e.ship&&e.isHit&&e.ship.damage<e.ship.size)return o.a.createElement(be.a,{icon:ve.d});if(e.ship&&e.isHit&&e.ship.damage===e.ship.size)return o.a.createElement(be.a,{icon:ve.e});if(!l&&!e.ship&&e.isHit)return o.a.createElement(be.a,{icon:Se.a});if(l)return o.a.createElement(be.a,{icon:ve.c});var s=t.recommendedShots.shots,c=t.recommendedShots.strategy;if(s.filter((function(t){return t.x===e.x&&t.y===e.y})).length>0){if("level2"===c)return o.a.createElement(be.a,{icon:Se.b});if("level3"===c)return o.a.createElement(be.a,{icon:ve.b})}return""}(t,r)))})),i}function Re(e,t,n,r){var a=function(e,t){var n=Ee(t),r=[];return r.push(o.a.createElement("div",{key:"hh-"+e,className:"col-sm-1 text-center align-middle text-light bg-secondary border border-secondary cell-base battle-field-border "+n},e)),r}(t[0].yLabel,r),i=[];return i.push(o.a.createElement("div",{key:"line-"+e,className:"row"},a,xe(e,t,n,r),a)),i}function _e(e,t,n){var r=[];return r.push(o.a.createElement("div",{key:"h-"+e,className:"row"},function(e,t){var n=[],r=Ee(t);return n.push(o.a.createElement("div",{key:"v-left",className:"col-sm-1 border border-secondary cell-base "+r})),e.forEach((function(e){n.push(o.a.createElement("div",{key:"v-"+e.x,className:"col-sm-1 text-center text-light bg-secondary cell-base battle-field-border "+r},e.xLabel))})),n.push(o.a.createElement("div",{key:"v-right",className:"col-sm-1 bg-secondary border border-secondary cell-base "+r})),n}(t[0],n))),r}var Oe=function(e){for(var t=e.cells,n=e.onCellClick,r=e.options,a=[],i=t.length-1;i>=0;i--)a.push(Re(i,t[i],n,r));return o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-sm-12"},_e("top",t,r),a,_e("bottom",t,r)))},Ce=function(e){var t=e.difficulty,n=e.showShotHints,r=e.onDifficultyChange,a=e.onShowShotHintsChange;return o.a.createElement("div",null,o.a.createElement("div",{className:"row mt-10"},o.a.createElement("div",{className:"col-sm-3 text-center small"},o.a.createElement("span",{className:"text-muted"},"HINTS")),o.a.createElement("div",{className:"col-sm-3 text-center small"},o.a.createElement("span",{className:"text-success"},"EASY")),o.a.createElement("div",{className:"col-sm-3 text-center small"},o.a.createElement("span",{className:"text-warning"},"MEDIUM")),o.a.createElement("div",{className:"col-sm-3 text-center small"},o.a.createElement("span",{className:"text-danger"},"HARD"))),o.a.createElement("div",{className:"row mt-10"},o.a.createElement("div",{className:"col-sm-3 small"},o.a.createElement("input",{type:"checkbox",name:"showShotHints",className:"form-control",checked:n,value:"true",onChange:a})),o.a.createElement("div",{className:"col-sm-3 text-center"},o.a.createElement("input",{type:"radio",name:"difficulty",className:"form-control",value:"1",checked:1===t,onChange:r.bind(void 0,1)})),o.a.createElement("div",{className:"col-sm-3 text-center"},o.a.createElement("input",{type:"radio",name:"difficulty",className:"form-control",value:"2",checked:2===t,onChange:r.bind(void 0,2)})),o.a.createElement("div",{className:"col-sm-3 text-center"},o.a.createElement("input",{type:"radio",name:"difficulty",className:"form-control",value:"3",checked:3===t,onChange:r.bind(void 0,3)}))))};var Pe=function(e){var t=e.ships,n=e.isPlayer,r=e.winner,a=e.points;if(!t||0===t.length)return"";var i=function(e){return e.sort((function(e,t){return t.size-e.size}))[0]}(t),l=[];t.forEach((function(e){l.push(o.a.createElement("div",{key:"ship-stat-line-"+e.id,className:"row mt-10"},o.a.createElement("div",{key:"ship-stat-col-"+e.id,className:"col-sm-12"},function(e,t,n){for(var r=[],a=1;a<=t;a++){var i=a<=e.size,l=e.damage===e.size;r.push(o.a.createElement("div",{key:"ship-stat-line-cell-"+e.id+"-"+a+"-"+(n?"-player":"-enemy"),className:"stat-cell"+(i?" stat-cell-ship":"")+(i&&l?" stat-cell-ship-killed":"")+(n?" float-right":""),title:e.name},"Â "))}return r}(e,i.size,n))))}));var s=r&&(n&&"enemy"===r||!n&&"player"===r);return o.a.createElement("div",null,o.a.createElement("div",{className:"row mt-10"},o.a.createElement("div",{className:"col-sm-12 text-center"+(s?" looser text-warning":"")},n?"Player":"Enemy")),l,o.a.createElement("div",{className:"row mt-10"},o.a.createElement("div",{className:"col-sm-12 text-center"},o.a.createElement("h1",null,a))))};var Ne=function(e){var t=e.logs;return o.a.createElement("div",null,function(e){var t=[],n=0;return e.sort((function(e,t){return t.time-e.time})).forEach((function(e){t.push(o.a.createElement("div",{key:"log-row-"+n,className:"row"},o.a.createElement("div",{key:"log-row-col-"+n,className:"col-sm-12 small text-muted"},e.text))),n++})),t}(t))};function je(e){return(je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Le(e,t){return(Le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ke(e,t){return!t||"object"!==je(t)&&"function"!=typeof t?He(e):t}function He(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ae(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function ze(e){return(ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Fe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Le(e,t)}(f,e);var t,n,r,a,u=(t=f,function(){var e,n=ze(t);if(Ae()){var r=ze(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return ke(this,e)});function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),Me(He(t=u.call(this,e)),"playerCellSetup",(function(e){})),Me(He(t),"startBattle",(function(){var e=Math.floor(Math.random()*Math.floor(2)),n=[t.createLogRecord("The battle has began! The first move: "+(0===e?"player":"enemy"))];1===e&&t.enemyMove();t.randomizeBattleFieldWithShips();t.setState({gameplay:{step:"STEP_BATTLE",currentMove:0===e?"player":"enemy",winner:null},logs:n})})),Me(He(t),"playerShot",(function(e){if("enemy"!==t.state.gameplay.currentMove){var n=t.state.enemy.cells,r=t.state.enemy.ships,o=!1,a=n[e.y][e.x];if(a.isHit)return t.state.logs.push(t.createLogRecord("Cell "+e.xLabel+e.yLabel+" has already been hit. Chose another one.")),void t.setState({logs:t.state.logs});if(a.isKilledShipNeighborCell)return t.state.logs.push(t.createLogRecord("Cell "+e.xLabel+e.yLabel+" is a neighbor of killed ship. Chose another one.")),void t.setState({logs:t.state.logs});a.isHit=!0;var l=t.state.enemy.damagedShipCells,s=a.ship;s||(t.state.logs.push(t.createLogRecord("Player: "+e.xLabel+e.yLabel+" - missed")),t.enemyMove()),s&&(s.damage++,s.damage===s.size?(t.state.logs.push(t.createLogRecord("Player: "+e.xLabel+e.yLabel+" - killed "+"#".repeat(s.size))),N(s,n),l=[]):(t.state.logs.push(t.createLogRecord("Player: "+e.xLabel+e.yLabel+" - damaged")),l.push(a)),(o=0===c(r))&&(i.a.fire("You have won","You're just lucky. You will have no chance next time","success"),t.state.logs.push(t.createLogRecord("Player won")))),t.setState({player:{cells:t.state.player.cells,ships:t.state.player.ships,lastShot:e,damagedShipCells:t.state.player.damagedShipCells,points:o?t.state.player.points+1:t.state.player.points},enemy:{cells:t.state.enemy.cells,ships:t.state.enemy.ships,lastShot:t.state.enemy.lastShot,damagedShipCells:l,points:t.state.enemy.points},gameplay:{step:o?"STEP_FINAL":t.state.gameplay.step,currentMove:o?null:s?"player":"enemy",winner:o?"player":null}})}})),Me(He(t),"enemyShot",(function(){var e=t.state.player.cells,n=t.state.player.ships,r=t.state.player.damagedShipCells,o=!1,a=ge(e,n,r,t.state.config.difficulty);a.isHit=!0;var l=a.ship;l&&(l.damage++,l.damage===l.size?(r=[],t.state.logs.push(t.createLogRecord("Enemy: "+a.xLabel+a.yLabel+" - killed "+"#".repeat(l.size))),N(l,e),(o=0===c(n))&&i.a.fire("Enemy has won!","You are loser. Live with this.","error")):(r.push(a),t.state.logs.push(t.createLogRecord("Enemy: "+a.xLabel+a.yLabel+" - damaged"))),o?t.state.logs.push(t.createLogRecord("Enemy won")):t.enemyMove()),l||t.state.logs.push(t.createLogRecord("Enemy: "+a.xLabel+a.yLabel+" - missed")),t.setState({player:{cells:t.state.player.cells,ships:t.state.player.ships,lastShot:t.state.player.lastShot,damagedShipCells:r,points:t.state.player.points},enemy:{cells:t.state.enemy.cells,ships:t.state.enemy.ships,lastShot:a,damagedShipCells:t.state.enemy.damagedShipCells,points:o?t.state.enemy.points+1:t.state.enemy.points},gameplay:{step:o?"STEP_FINAL":t.state.gameplay.step,currentMove:o?null:l?"enemy":"player",winner:o?"enemy":null}})})),Me(He(t),"enemyMove",(function(){window.setTimeout((function(){return t.enemyShot()}),500)})),Me(He(t),"randomizeBattleFieldWithShips",(function(){return function(e){var t=[{id:11,name:"Aquila (patrol boat)",size:1,cells:[],damage:0},{id:12,name:"Tornado (patrol boat)",size:1,cells:[],damage:0},{id:13,name:"Pegasus (patrol boat)",size:1,cells:[],damage:0},{id:14,name:"Hercules (patrol boat)",size:1,cells:[],damage:0},{id:21,name:"Annapolis (destroyer)",size:2,cells:[],damage:0},{id:22,name:"St Francis (destroyer)",size:2,cells:[],damage:0},{id:31,name:"Aaron Ward (destroyer)",size:2,cells:[],damage:0},{id:32,name:"Hobart (cruiser)",size:3,cells:[],damage:0},{id:33,name:"Canberra (cruiser)",size:3,cells:[],damage:0},{id:41,name:"Missouri (battleship)",size:4,cells:[],damage:0}];return t.reverse().forEach((function(t){var n=t.size,r=C(e,n);r.roomCells.forEach((function(e){e.ship=t})),r.roomCells.forEach((function(t){O(e,t,"isShipNeighbor")}))})),{cells:e,ships:t}}(function(e){for(var t=[],n=e-1;n>=0;n--){t[n]=[];for(var r=e-1;r>=0;r--)t[n][r]={id:l[r]+(n+1),x:r,y:n,xLabel:l[r],yLabel:n+1,ship:null,isHit:!1,isShipNeighbor:!1,isKilledShipNeighborCell:!1}}return t}(10))})),Me(He(t),"onNewGameClick",(function(){t.setState((function(e){return t.getInitialState(e)}))})),Me(He(t),"getInitialState",(function(e){var n=t.randomizeBattleFieldWithShips(),r=t.randomizeBattleFieldWithShips();return{player:{cells:n.cells,ships:n.ships,lastShot:null,damagedShipCells:[],points:e?e.player.points:0},enemy:{cells:r.cells,ships:r.ships,lastShot:null,damagedShipCells:[],points:e?e.enemy.points:0},config:{showShotHints:!e||e.config.showShotHints,difficulty:e?e.config.difficulty:3},gameplay:{step:"STEP_READY_TO_START",currentMove:null,winner:null},logs:[t.createLogRecord("New game is initialized. Click START button when ready.")]}})),Me(He(t),"createLogRecord",(function(e){return{time:new Date,text:e}})),Me(He(t),"onDifficultyChange",(function(e){t.setState({config:{showShotHints:t.state.config.showShotHints,difficulty:e}})})),Me(He(t),"onShowShotHintsChange",(function(e){var n=e.target.checked;t.setState({config:{showShotHints:n,difficulty:t.state.config.difficulty}})})),t.state=t.getInitialState(null),t}return n=f,(r=[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(){}},{key:"render",value:function(){var e=this.state.gameplay.step,t=this.state.gameplay.currentMove,n=this.state.config.difficulty,r={isPlayer:!0,stage:e,lastShot:this.state.enemy.lastShot,currentMove:t,highlightBattleArea:"STEP_BATTLE"===e&&"enemy"===t,recommendedShots:{shots:[],strategy:null}},a=this.state.config.showShotHints&&"STEP_BATTLE"===e?function(e,t,n,r){if(n.length>0)return{shots:(new D).getCells(e,n),strategy:"level3"};if(1===r)return{shots:[],strategy:"level1"};if(p(e)<10)return{shots:[],strategy:"no-strategy-for-first-shots"};if(1===s(t).size)return{shots:[],strategy:"single-ship-no-strategy"};if(2===r)return{shots:me(e,t),strategy:"level2"};if(3===r){var o=de(e,t);return o.length>0?{shots:o,strategy:"level3"}:{shots:me(e,t),strategy:"level2"}}return{shots:[],strategy:"no-strategy-stub"}}(this.state.enemy.cells,this.state.enemy.ships,this.state.enemy.damagedShipCells,n):{shots:[],strategy:"hits-are-disabled"},i={isPlayer:!1,stage:e,lastShot:this.state.player.lastShot,recommendedShots:a,highlightBattleArea:"STEP_BATTLE"===e&&"player"===t,currentMove:t};return o.a.createElement("div",null,o.a.createElement("div",{className:"row mt-10"},o.a.createElement("div",{className:"col-sm-1"},o.a.createElement(Pe,{ships:this.state.player.ships,isPlayer:!0,winner:this.state.gameplay.winner,points:this.state.player.points})),o.a.createElement("div",{className:"col-sm-5"+(r.highlightBattleArea?"":" disabledArea"),disabled:r.highlightBattleArea},o.a.createElement(Oe,{cells:this.state.player.cells,options:r,onCellClick:this.playerCellSetup})),o.a.createElement("div",{className:"col-sm-5"+(i.highlightBattleArea?"":" disabledArea"),disabled:i.highlightBattleArea},o.a.createElement(Oe,{cells:this.state.enemy.cells,options:i,onCellClick:this.playerShot})),o.a.createElement("div",{className:"col-sm-1"},o.a.createElement(Pe,{ships:this.state.enemy.ships,isPlayer:!1,winner:this.state.gameplay.winner,points:this.state.enemy.points}))),o.a.createElement("div",{className:"row mt-10"},o.a.createElement("div",{className:"col-sm-4"},o.a.createElement(Ce,{difficulty:n,showShotHints:this.state.config.showShotHints,onDifficultyChange:this.onDifficultyChange,onShowShotHintsChange:this.onShowShotHintsChange})),o.a.createElement("div",{className:"col-sm-4 text-center btn-lg"},o.a.createElement("button",{className:"bg-primary button-rounded",onClick:this.onNewGameClick},"New game"),o.a.createElement("button",{className:"bg-primary button-rounded",onClick:this.startBattle,disabled:"STEP_READY_TO_START"!==this.state.gameplay.step},"Start")),o.a.createElement("div",{className:"col-sm-4"})),o.a.createElement("div",{className:"row mt-10"},o.a.createElement("div",{className:"col-sm-12"},o.a.createElement(Ne,{logs:this.state.logs}))))}}])&&Te(n.prototype,r),a&&Te(n,a),f}(r.Component)}});